# All logs start being sent to the unparsed index.
# The filters below will route them to the @index=app or @index=platform
 mutate {
     add_field => { "[@metadata][index]" => "unparsed" }
     add_field => { "[@metadata][type]" => "%{[@type]}" }
     remove_field => "@type"
 }

if [@metadata][type] == "NATS" {
<%= File.read('src/logstash-filters/snippets/bosh_nats.conf').gsub(/^/, '  ') %>
}

#Cleanup
mutate {
  rename => { "[tags]" => "[@tags]" }
  remove_field => [ "@version" ]
}
